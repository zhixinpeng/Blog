**后进者先出，先进者后出，这就是典型的”栈“结构**

## 如何实现一个栈

用数组实现的栈，我们叫做**顺序栈**，用链表实现的栈，我们叫做**链式栈**。

```java
public class ArrayStack {
  // 数组
  private String[] items;
  // 栈中元素个数
  private int count;
  // 栈的大小
  private int n;
  
  // 初始化数组，申请一个大小为 n 的数组空间
  public ArrayStack(int n){
    this.items = new String[n];
    this.n = n;
    this.count = 0;
  }
  
  // 入栈操作
  public boolean push(String item){
    // 数组空间不够了，直接返回 false，入栈失败
    if(count == n) return false;
    // 将 item 放到下标为 count 的位置，并且 count 加一
    items[count] = item;
    ++count;
    return true;
  }
  
  // 出栈操作
  public String pop(){
    // 栈为空，则直接返回 null
    if(count == 0) return null;
    // 返回下标为 count - 1 的数组元素，并且栈中元素个数 count 减一
    String temp = items[count - 1];
    --count;
    return temp;
  }
}
```

不管是顺序栈还是链式栈，入栈、出栈时间复杂度为 O(1)，空间复杂度为 O(1)。

## 栈在函数调用中的应用

栈作为一个比较基础的数据结构，在实际应用中有非常丰富的使用场景。其中，比较经典的一个应用场景之一就是**函数调用栈**。

操作系统给每个线程分配了一块独立的内存空间，这块内存空间被组织成”栈“这种结构，用来存储函数调用时的临时变量。每进入一个函数，就会将临时变量作为一个栈帧入栈，当函数被执行完成之后，将这个函数对应的栈帧出栈。

![img](https://static001.geekbang.org/resource/image/17/1c/17b6c6711e8d60b61d65fb0df5559a1c.jpg)

## 栈在表达式求值中的应用

另外一个常见的应用场景，编译器如何利用栈来实现**表达式求值**。

计算机是如何来计算比如：34 + 13 * 9 + 44 - 12 / 3 这个表达式的结果呢？

实际上，编译器就是通过两个栈来实现的。其中一个保存操作数的栈，另一个保存运算符的栈。从左到右遍历表达式，当遇到数字，直接压入操作数栈；当遇到运算符，就与运算符栈的栈顶元素进行比较。

如果比栈顶元素优先级高，就将当前运算符压入栈；如果比栈顶元素优先级低或相同，从运算符栈中取栈顶运算符，从操作数栈的栈顶取 2 个操作数，然后进行计算，再把计算结果压入操作数栈，继续比较。

![img](https://static001.geekbang.org/resource/image/bc/00/bc77c8d33375750f1700eb7778551600.jpg)

## 栈在括号匹配中的应用

假设表达式中只有三种括号，圆括号()、方括号[]和花括号{}，并且他们可以任意嵌套，左右匹配为合法字符，否则为不合法字符，如何检查呢？

从左到右扫码字符串，扫描到左括号时，压入栈中；扫描到右括号时，从栈顶取出一个左括号。如果能够匹配，比如“(”跟“)”匹配，“[”跟”]”匹配，“{”跟”}”匹配，则继续扫描剩下的字符串。如果扫描过程中，遇到不能配对的右括号，或者栈中没有数据，则说明为非法格式。

当所有括号都扫描完成之后，如果栈为空，则说明字符串为合法格式；否则，说明有未匹配的左括号，为非法格式。

## 如何用栈来实现浏览器的前进、后退功能

使用两个栈，X 和 Y，首次浏览的页面依次压入栈 X，当点击后退按钮时，再依次从 X 中出栈，并将出栈数据依次放入栈 Y。当点击前进按钮时，再从栈 Y 中取出数据，放入栈 X 中。当 X 中没有数据时，说明没有页面可以继续后退，当 Y 中没有数据时，说明没有页面可以点击前进按钮浏览了。