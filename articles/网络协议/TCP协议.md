## TCP 的三次握手

A：你好，我是 A。

B：你好，我是 B。

A：你好 B。

首先，为什么是三次而不是两次？A要发起一个连接，当发了第一个请求了无音信的时候，会有很多可能性，比如第一个请求丢包了，没有丢也可能走弯路超时了，或者 B 没有响应，不想和我连接。

A 不能确认结果，就一直发。终于有一个请求包到达 B 了，但是请求包到了 B 这个事情 A 并不知道，A 还可能再发。

B 收到包就知道 A 的存在了，并且知道 A 要和他建立连接。如果 B 不愿意建立连接，A 在重试一阵子之后就会放弃连接。如果 B 是乐意的，就会发送应答给 A。

![img](https://static001.geekbang.org/resource/image/c0/08/c067fe62f49e8152368c7be9d91adc08.jpg)

## TCP 四次挥手

A：B 啊，我不想玩了

B：哦，你不想玩了，我知道了

这个时候只是 A 不想玩了而已，即 A 不会再发送数据了。但是 B 不能立马关闭，B 还有自己要做的事情，还是可以发送数据的，称为半关闭状态。

B：A 啊，我也不想玩了，拜拜

A：好的，拜拜

![img](https://static001.geekbang.org/resource/image/bf/13/bf1254f85d527c77cc4088a35ac11d13.jpg)